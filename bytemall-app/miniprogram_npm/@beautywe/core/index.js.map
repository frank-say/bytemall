{"version":3,"sources":["index.js","class/bt-app.js","class/host.js","lib/logger.js","class/bt-plugin.js","lib/error.js","class/bt-page.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA;ACFA,ACHA,AFMA,AGTA;AFOA,ACHA,AFMA,AGTA;AFOA,ACHA,AFMA,AGTA;AFOA,AGTA,AFMA,AFMA,AGTA;AFOA,AGTA,AFMA,AFMA,AGTA;AFOA,AGTA,AFMA,AFMA,AGTA;AFOA,AGTA,AFMA,AFMA,AKfA,AFMA;AFOA,AGTA,AFMA,AFMA,AKfA,AFMA;AFOA,AGTA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AKfA,AFMA;AFOA,AKfA,AFMA,AFMA,AFMA,AGTA;AFOA,AKfA,AFMA,AFMA,AFMA,AGTA;AFOA,AKfA,AFMA,AFMA,AFMA,AGTA;AFOA,AKfA,AFMA,AFMA,AFMA,AGTA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AFOA,AKfA,AFMA,AFMA,ACHA;AGRA,AFMA,AFMA,ACHA;AGRA,AFMA,AFMA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;AGRA,AJYA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA,ACHA;ADIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"BtApp\", {\n  enumerable: true,\n  get: function get() {\n    return _btApp[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"BtPage\", {\n  enumerable: true,\n  get: function get() {\n    return _btPage[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"BtPlugin\", {\n  enumerable: true,\n  get: function get() {\n    return _btPlugin[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"Host\", {\n  enumerable: true,\n  get: function get() {\n    return _host[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"error\", {\n  enumerable: true,\n  get: function get() {\n    return _error[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"Logger\", {\n  enumerable: true,\n  get: function get() {\n    return _logger.Logger;\n  }\n});\nexports[\"default\"] = void 0;\n\nvar _btApp = _interopRequireDefault(require(\"./class/bt-app\"));\n\nvar _btPage = _interopRequireDefault(require(\"./class/bt-page\"));\n\nvar _btPlugin = _interopRequireDefault(require(\"./class/bt-plugin\"));\n\nvar _host = _interopRequireDefault(require(\"./class/host\"));\n\nvar _error = _interopRequireDefault(require(\"./lib/error\"));\n\nvar _logger = require(\"./lib/logger\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _default = {\n  BtApp: _btApp[\"default\"],\n  BtPage: _btPage[\"default\"],\n  BtPlugin: _btPlugin[\"default\"],\n  error: _error[\"default\"],\n  Logger: _logger.Logger,\n  Host: _host[\"default\"]\n};\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _host = _interopRequireDefault(require(\"./host\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar NATIVE_HOOKS = [// 保持第 0 位，为启动钩子\n'onLaunch', 'onShow', 'onHide', // \bonError 不能监听，发生错误的时候，会发生死循环。\n// 'onError',\n'onPageNotFound'];\n\nvar BtApp =\n/*#__PURE__*/\nfunction (_Host) {\n  _inherits(BtApp, _Host);\n\n  function BtApp(content) {\n    var _this;\n\n    _classCallCheck(this, BtApp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BtApp).call(this, {\n      nativeHookNames: NATIVE_HOOKS,\n      launchHookName: NATIVE_HOOKS[0]\n    }));\n\n    if (content) {\n      Object.keys(content).forEach(function (key) {\n        if (NATIVE_HOOKS.indexOf(key) !== -1) {\n          // register native hook function\n          if (typeof content[key] === 'function') {\n            _this.pushHookFun(key, content[key]);\n          }\n        } else {\n          // protected domain check\n          if (_this[key] !== undefined) {\n            throw new Error(\"you can't use protected domain: \".concat(key, \" at BtApp\"));\n          }\n\n          _this[key] = content[key];\n        }\n      });\n    }\n\n    return _this;\n  }\n\n  return BtApp;\n}(_host[\"default\"]);\n\nvar _default = BtApp;\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _logger = _interopRequireDefault(require(\"../lib/logger\"));\n\nvar _btPlugin = _interopRequireDefault(require(\"./bt-plugin\"));\n\nvar _error = _interopRequireDefault(require(\"../lib/error\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * 计算需要依赖的但并没有引入的 plugins\n * @param {Host} options.theHost\n * @param {Array} options.relyOn\n */\nfunction getNotIncludedPlugins(_ref) {\n  var theHost = _ref.theHost,\n      relyOn = _ref.relyOn;\n  var thePluginsWasNotIncluded = [];\n\n  function wasIncluded(relyConf, plugin) {\n    var nameEqual = plugin.name === relyConf.name;\n    var npmNameEqual = relyConf.npmName ? relyConf.npmName === plugin.npmName : true;\n    var versionEqual = relyConf.version ? relyConf.version === plugin.version : true;\n    return nameEqual && npmNameEqual && versionEqual;\n  }\n\n  if (theHost._btPlugin.plugins) {\n    relyOn.forEach(function (rely) {\n      var relyConf = rely;\n      if (typeof rely === 'string') relyConf = {\n        name: rely\n      };\n      thePluginsWasNotIncluded.push(relyConf);\n\n      theHost._btPlugin.plugins.forEach(function (plugin) {\n        if (wasIncluded(relyConf, plugin)) {\n          thePluginsWasNotIncluded.pop();\n        }\n      });\n    });\n  }\n\n  return thePluginsWasNotIncluded;\n}\n/**\n * 按循序执行 Promise 任务\n * @param {Array} options.tasks 要执行的任务队列\n * @param {Host} options.thisIns 宿主实例\n * @param {*} options.arg 透传的参数\n */\n\n\nfunction sequenceTasks(_ref2) {\n  var tasks = _ref2.tasks,\n      thisIns = _ref2.thisIns,\n      arg = _ref2.arg;\n\n  function recordValue(results, value) {\n    results.push(value);\n    return results;\n  }\n\n  var pushValue = recordValue.bind(null, []);\n  return tasks.reduce(function (promise, task) {\n    return promise.then(function () {\n      return task.apply(thisIns, arg);\n    }).then(pushValue);\n  }, Promise.resolve());\n}\n/**\n * 绑定 theHost 到 funcs 下的所有方法的 this\n * @param {Host} theHost\n * @param {Object} funs\n */\n\n\nfunction deepBind(_ref3) {\n  var theHost = _ref3.theHost,\n      funs = _ref3.funs,\n      domain = _ref3.domain;\n  var result = {};\n  if (domain) result[domain] = {};\n  Object.keys(funs).forEach(function (funName) {\n    var fun = funs[funName];\n    if (fun === undefined) return; // 如果当前 value 是 object，递归。\n\n    if (!Array.isArray(fun) && fun !== null && _typeof(fun) === 'object') {\n      if (domain) result[domain][funName] = deepBind({\n        theHost: theHost,\n        funs: fun\n      });else result[funName] = deepBind({\n        theHost: theHost,\n        funs: fun\n      });\n    } // 如果当前 value 是 function，则 bind this with theHost\n\n\n    if (typeof fun === 'function') {\n      if (domain) result[domain][funName] = fun.bind(theHost);else result[funName] = fun.bind(theHost);\n    }\n  });\n  return result;\n}\n/**\n * 钩子函数可插件化\n * 1. 对 native Hook 可插件化\n * 2. 对 handler Hook 可插件化\n * @param {String} theHost\n * @param {String} funName\n */\n\n\nfunction hookFunPluggablify(_ref4) {\n  var theHost = _ref4.theHost,\n      funName = _ref4.funName,\n      beforeCall = _ref4.beforeCall;\n  // initializeize function queue (overwrite pluggabled function)\n  theHost.newHookFunQueue(funName); // 避免重复改造，造成无限递归\n\n  if (theHost[funName] && theHost[funName].isPluggableHookFun) {\n    _logger[\"default\"].warn(\"hook function(\".concat(funName, \") has been pluggabled, do not allow repetition.\"));\n\n    return;\n  } // 标记 isPluggableHookFun，避免重复改造，造成无限递归。\n\n\n  theHost[funName] = Object.defineProperty(function pluggableHookFun() {\n    var _theHost = this;\n\n    if (typeof beforeCall === 'function') beforeCall({\n      theHost: _theHost\n    });\n\n    var funQueue = _theHost.getHookFunQueue(funName); // 如果不存在，则 resolve\n\n\n    if (!funQueue || !Array.isArray(funQueue)) return Promise.resolve(); // 以 「先进先出」 的形式按顺序执行 Promise 链，未捕捉的错误，扔到 onError 去。\n\n    for (var _len = arguments.length, arg = new Array(_len), _key = 0; _key < _len; _key++) {\n      arg[_key] = arguments[_key];\n    }\n\n    return sequenceTasks({\n      tasks: funQueue,\n      thisIns: _theHost,\n      arg: arg\n    })[\"catch\"](function (err) {\n      if (typeof _theHost.onError === 'function') {\n        _theHost.onError(err);\n      }\n\n      throw err;\n    });\n  }, 'isPluggableHookFun', {\n    value: true\n  });\n}\n/**\n * 插入一个 plugin\n * @param {Host} theHost\n * @param {BtPlugin} plugin\n */\n\n\nfunction attachPlugin(_ref5) {\n  var theHost = _ref5.theHost,\n      plugin = _ref5.plugin;\n  // check domain conflict\n  if (!theHost.data) theHost.data = {};\n  if (theHost.data[plugin.name]) throw new _error[\"default\"](\"theHost.data.\".concat(plugin.name, \" \\u547D\\u540D\\u7A7A\\u95F4\\u88AB\\u5360\\u7528\\u4E86\\uFF0C\\u63D2\\u4EF6 \").concat(plugin.name, \" \\u9700\\u8981\\u7528\\u5230\\u8BE5\\u547D\\u540D\\u7A7A\\u95F4\\uFF0C\\u4F60\\u53EF\\u4EE5\\u66F4\\u6539\\u63D2\\u4EF6\\u540D\\uFF08plugin.name = xxx\\uFF09\\u6216\\u8005\\u624B\\u52A8\\u66F4\\u6539\\u5BBF\\u4E3B data \\u90E8\\u5206\\u6765\\u5904\\u7406\\u51B2\\u7A81\"));\n  if (theHost[plugin.name]) throw new _error[\"default\"](\"theHost.\".concat(plugin.name, \" \\u547D\\u540D\\u7A7A\\u95F4\\u88AB\\u5360\\u7528\\u4E86\\uFF0C\\u63D2\\u4EF6 \").concat(plugin.name, \" \\u9700\\u8981\\u7528\\u5230\\u8BE5\\u547D\\u540D\\u7A7A\\u95F4\\uFF0C\\u4F60\\u53EF\\u4EE5\\u66F4\\u6539\\u63D2\\u4EF6\\u540D\\uFF08plugin.name = xxx\\uFF09\\u6216\\u8005\\u624B\\u52A8\\u5904\\u7406\\u51B2\\u7A81\")); // attach data\n\n  if (plugin.content.data) {\n    theHost.data[plugin.name] = plugin.content.data;\n  } // attach custom method\n\n\n  if (plugin.content.custom) {\n    theHost.pushInitFun(function (_ref6) {\n      var _theHost = _ref6.theHost;\n      Object.assign(_theHost, deepBind({\n        theHost: _theHost,\n        funs: plugin.content.custom,\n        domain: plugin.name\n      }));\n    });\n  } // attach native hook\n\n\n  if (plugin.content.nativeHook) {\n    var nativeHooks = plugin.content.nativeHook;\n    Object.keys(nativeHooks).forEach(function (funName) {\n      if (typeof nativeHooks[funName] !== 'function') {\n        _logger[\"default\"].warn(\"nativeHook attach fail\\uFF0Cthe native hook(\".concat(funName, \") should be a function\"));\n\n        return;\n      }\n\n      if (!theHost.getHookFunQueue(funName)) {\n        _logger[\"default\"].warn(\"nativeHook attach fail\\uFF0Cthe native hook(\".concat(funName, \") not be support on the host\"));\n\n        return;\n      }\n\n      theHost.pushHookFun(funName, nativeHooks[funName]);\n    });\n  } // attach handler hook\n\n\n  if (plugin.content.handler) {\n    var handlerHooks = plugin.content.handler;\n    Object.keys(handlerHooks).forEach(function (funName) {\n      if (theHost._btPlugin.nativeHookNames.indexOf(funName) !== -1) {\n        _logger[\"default\"].warn(\"nativeHook \".concat(funName, \" not be allow definded on handler.\"));\n\n        return;\n      }\n\n      if (!theHost.getHookFunQueue(funName)) {\n        var originFun;\n        if (typeof theHost[funName] === 'function') originFun = theHost[funName];\n        hookFunPluggablify({\n          theHost: theHost,\n          funName: funName\n        });\n        theHost.pushHookFun(funName, originFun);\n      }\n\n      theHost.pushHookFun(funName, handlerHooks[funName]);\n    });\n  } // attach initialize function\n\n\n  if (typeof plugin.initialize === 'function') {\n    theHost.pushInitFun(plugin.initialize.bind(plugin));\n  }\n}\n\nvar Host =\n/*#__PURE__*/\nfunction () {\n  /**\n   * New a host\n   * @param {Array} options.nativeHookNames\n   * @param {String} options.launchHookName\n   */\n  function Host(_ref7) {\n    var _this = this;\n\n    var _ref7$nativeHookNames = _ref7.nativeHookNames,\n        nativeHookNames = _ref7$nativeHookNames === void 0 ? [] : _ref7$nativeHookNames,\n        launchHookName = _ref7.launchHookName;\n\n    _classCallCheck(this, Host);\n\n    _defineProperty(this, \"pushHookFun\", function (funName, func) {\n      _this._btPlugin.pluggableFunQueueMap[funName].push(func);\n    });\n\n    _defineProperty(this, \"newHookFunQueue\", function (funName) {\n      _this._btPlugin.pluggableFunQueueMap[funName] = [];\n    });\n\n    _defineProperty(this, \"getHookFunQueue\", function (funName) {\n      return _this._btPlugin.pluggableFunQueueMap[funName];\n    });\n\n    _defineProperty(this, \"pushInitFun\", function (func) {\n      _this._btPlugin.pluginsInitializeQueue.push(func);\n    });\n\n    _defineProperty(this, \"getInitFunQueue\", function () {\n      return _this._btPlugin.pluginsInitializeQueue;\n    });\n\n    // new a domain space\n    this._btPlugin = {\n      nativeHookNames: nativeHookNames,\n      // 存放 attached plugin info\n      plugins: [],\n      // 存放插件化的函数队列（native hook & handler hook）\n      // （这个队列里面的方法，会在对应的钩子函数触发的时候被执行，参数：this => theHost，以及原有参数透传）\n      pluggableFunQueueMap: {},\n      // 存放每个插件的 initialize 方法，\n      // （这个队列里面的方法，会在 onLoad,onLaunch 的时候会已同步的形式执行，参数：{ theHost } ）\n      pluginsInitializeQueue: []\n    };\n    nativeHookNames.forEach(function (funName) {\n      if (funName === launchHookName) {\n        // custom method pluggable\n        hookFunPluggablify({\n          theHost: _this,\n          funName: funName,\n          beforeCall: function beforeCall(_ref8) {\n            var theHost = _ref8.theHost;\n            theHost.getInitFunQueue().forEach(function (task) {\n              return task({\n                theHost: theHost\n              });\n            });\n          }\n        });\n      } else {\n        // hook function pluggable\n        hookFunPluggablify({\n          theHost: _this,\n          funName: funName\n        });\n      }\n    });\n  }\n  /**\n   * Use Plugin 使用插件\n   * @param {object} plugins instance array of class BtPlugin\n   * @param {object} plugins[n].name name of plugin\n   * @param {object} plugins[n].content content of plugin\n   * @param {object} plugins[n].content.data data for the host\n   * @param {object} plugins[n].content.handler handler method for the host\n   * @param {object} plugins[n].content.nativeHook nativeHook method for the host\n   * @param {object} plugins[n].content.customMethod customMethod method for the host\n   * @param {object} plugins[n].options options of plugin\n   * @param {Array} plugins[n].options.relyOn options of plugin\n   * @param {object} plugins[n].beforeAttach 插件装载前的钩子方法，beforeAttach({ theHost })\n   * @param {object} plugins[n].attached 插件装载完成的钩子方法，attached({ theHost })\n   * @param {object} plugins[n].initialize 初始化方法，会在宿主启动的时候初始化，已同步的形式执行，initialize({ theHost })\n   */\n\n\n  _createClass(Host, [{\n    key: \"use\",\n    value: function use(plugins) {\n      var _this2 = this;\n\n      var theHost = this;\n      var plgs = plugins;\n      if (!plgs) throw new Error('params is required'); // compatibel array and object\n\n      if (plgs && !Array.isArray(plgs)) plgs = [plugins];\n\n      var _loop = function _loop(index) {\n        // new a BtPlugin instance\n        var plugin = new _btPlugin[\"default\"](plgs[index]); // self registerd checking\n\n        if (theHost._btPlugin.plugins.map(function (item) {\n          return item.name;\n        }).indexOf(plugin.name) !== -1) {\n          throw new _error[\"default\"](\"\".concat(plugin.name, \" \\u5DF2\\u7ECF\\u6CE8\\u518C\\u4E86\\uFF0C\\u4E0D\\u5141\\u8BB8\\u91CD\\u590D\\u6CE8\\u518C\"));\n        } // rely on checking\n\n\n        var relyOn = plugin.options.relyOn;\n\n        if (relyOn && Array.isArray(relyOn)) {\n          var thePluginsWasNotIncluded = getNotIncludedPlugins({\n            theHost: theHost,\n            relyOn: relyOn\n          });\n\n          if (thePluginsWasNotIncluded.length > 0) {\n            thePluginsWasNotIncluded.forEach(function (need) {\n              var message = \"\\u63D2\\u4EF6 \".concat(plugin.name, \" \\u4F9D\\u8D56\\u63D2\\u4EF6 \").concat(need.name, \"\\uFF0C\\u8BF7\\u5148\\u6CE8\\u518C \").concat(need.name);\n\n              if (need.npmName) {\n                var installMessage = need.version ? \"\".concat(need.npmName, \"@\").concat(need.version) : \"\".concat(need.npmName);\n                message += \", \\u4F60\\u53EF\\u4EE5\\u901A\\u8FC7\\u4EE5\\u4E0B\\u547D\\u4EE4\\u5B89\\u88C5\\u5B83 'npm i \".concat(installMessage, \"'\");\n              }\n\n              _logger[\"default\"].error(message);\n            });\n            throw new _error[\"default\"](\"\\u6709 \".concat(thePluginsWasNotIncluded.length, \" \\u4E2A \").concat(plugin.name, \" \\u7684\\u4F9D\\u8D56\\u63D2\\u4EF6\\u672A\\u9884\\u6CE8\\u518C\"));\n          }\n        } // record plugin info into this._btPlugin.plugins\n\n\n        var pluginInfo = {\n          name: plugin.name\n        };\n        if (plugin.npmName) pluginInfo.npmName = plugin.npmName;\n        if (plugin.version) pluginInfo.version = plugin.version;\n\n        theHost._btPlugin.plugins.push(pluginInfo); // do plugin beforeAttach hook functions\n\n\n        if (typeof plugin.beforeAttach === 'function') plugin.beforeAttach({\n          theHost: theHost\n        }); // attach plugin\n\n        attachPlugin({\n          theHost: _this2,\n          plugin: plugin\n        }); // do plugin attached hook functions\n\n        if (typeof plugin.attached === 'function') plugin.attached({\n          theHost: theHost\n        });\n      };\n\n      for (var index = 0; index < plgs.length; index += 1) {\n        _loop(index);\n      }\n    }\n  }]);\n\n  return Host;\n}();\n\nvar _default = Host;\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.Logger = exports.logger = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Logger =\n/*#__PURE__*/\nfunction () {\n  function Logger() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        prefix = _ref.prefix;\n\n    _classCallCheck(this, Logger);\n\n    this.prefix = prefix;\n  }\n\n  _createClass(Logger, [{\n    key: \"warn\",\n    value: function warn() {\n      var _console;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return (_console = console).warn.apply(_console, [\"[\".concat(this.prefix, \":waring]\")].concat(args));\n    }\n  }, {\n    key: \"info\",\n    value: function info() {\n      var _console2;\n\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return (_console2 = console).info.apply(_console2, [\"[\".concat(this.prefix, \":info]\")].concat(args));\n    }\n  }, {\n    key: \"error\",\n    value: function error() {\n      var _console3;\n\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      return (_console3 = console).error.apply(_console3, [\"[\".concat(this.prefix, \":error]\")].concat(args));\n    }\n  }, {\n    key: \"debug\",\n    value: function debug() {\n      var _console4;\n\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return (_console4 = console).debug.apply(_console4, [\"[\".concat(this.prefix, \":debug]\")].concat(args));\n    }\n  }]);\n\n  return Logger;\n}();\n\nexports.Logger = Logger;\nvar logger = new Logger({\n  prefix: 'BeautyWe'\n});\nexports.logger = logger;\nvar _default = logger;\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _error = _interopRequireDefault(require(\"../lib/error\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BtPlugin =\n/**\n * Crate a BtPlugin instance\n * @param {String} content.name 插件名\n * @param {Function} [content.beforeAttach] 插件装载前的钩子方法，beforeAttach({ theHost })\n * @param {Function} [content.attached] 插件装载完成的钩子方法，attached({ theHost })\n * @param {Function} [content.initialize] 初始化方法，会在宿主启动的时候初始化，已同步的形式执行，initialize({ theHost })\n * @param {Object} [content.data] 可选，混入到宿主的 data 部分\n * @param {Object} [content.customMethod] 可选，混入到宿主的自定义方法\n * @param {Object} [content.nativeHook] 可选，混入到宿主的原生钩子方法\n * @param {Object} [content.handler] 可选，混入到宿主的事件监听函数\n * @param {String} [content.npmName] 可选，插件在 npm 的名字，用来处理插件之间的冲突与依赖问题。\n * @param {String} [content.version] 可选，插件在 npm 的版本号，用来处理插件之间的冲突与依赖问题。\n * @param {Collection|Object|String} [content.relyOn] 用来检查依赖插件，支持 string, object{name, version, npmName}。\n * @param {string} [content.relyOn.npmName] npm 包的名字，可选\n * @param {string} [content.relyOn.version] npm 包的版本号，可选\n */\nfunction BtPlugin() {\n  var content = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  _classCallCheck(this, BtPlugin);\n\n  if (!content.name) throw new _error[\"default\"]('params of name are required when create a BtPlugin.');\n  this.name = content.name;\n  this.npmName = content.npmName;\n  this.version = content.version;\n  this.content = {\n    data: content.data,\n    custom: content.customMethod,\n    nativeHook: content.nativeHook,\n    handler: content.handler\n  };\n  this.options = {\n    relyOn: content.relyOn\n  };\n\n  if (typeof content.beforeAttach === 'function') {\n    this.beforeAttach = content.beforeAttach.bind(this);\n  }\n\n  if (typeof content.attached === 'function') {\n    this.attached = content.attached.bind(this);\n  }\n\n  if (typeof content.initialize === 'function') {\n    this.initialize = content.initialize.bind(this);\n  }\n};\n\nvar _default = BtPlugin;\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar BtError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(BtError, _Error);\n\n  function BtError(message) {\n    _classCallCheck(this, BtError);\n\n    var _msg = \"[BeautyWe:error] \".concat(message);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(BtError).call(this, _msg));\n  }\n\n  return BtError;\n}(_wrapNativeSuper(Error));\n\nvar _default = BtError;\nexports[\"default\"] = _default;","\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _host = _interopRequireDefault(require(\"./host\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar NATIVE_HOOKS = [// 保持第 0 位，为启动钩子\n'onLoad', 'onShow', 'onReady', 'onHide', 'onUnload', 'onPullDownRefresh', 'onReachBottom', 'onPageScroll', 'onResize', 'onTabItemTap'];\n\nvar BtPage =\n/*#__PURE__*/\nfunction (_Host) {\n  _inherits(BtPage, _Host);\n\n  function BtPage(content) {\n    var _this;\n\n    _classCallCheck(this, BtPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BtPage).call(this, {\n      nativeHookNames: NATIVE_HOOKS,\n      launchHookName: NATIVE_HOOKS[0]\n    }));\n\n    if (content) {\n      Object.keys(content).forEach(function (key) {\n        if (NATIVE_HOOKS.indexOf(key) !== -1) {\n          // register native hook function\n          if (typeof content[key] === 'function') {\n            _this.pushHookFun(key, content[key]);\n          }\n        } else {\n          // protected domain check\n          if (_this[key] !== undefined) {\n            throw new Error(\"you can't use protected domain: \".concat(key, \" at BtPage\"));\n          }\n\n          _this[key] = content[key];\n        }\n      });\n    }\n\n    return _this;\n  }\n\n  return BtPage;\n}(_host[\"default\"]);\n\nvar _default = BtPage;\nexports[\"default\"] = _default;"]}